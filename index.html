<!DOCTYPE html>

<html lang="en">

<head>
    <!-- icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <title>FGMM-Simulador</title>
    <meta charset="utf-8" />

    <!-- Bootstrap JavaScript and Popper.js -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>


    <script type="text/javascript" src="css/dummy.js"></script>
    <!-- css -->
    <link rel="stylesheet" type="text/css" href="css/result-light.css">
    <link rel="stylesheet" type="text/css" href="css/codemirror.css">
    <link rel="stylesheet" type="text/css" href="css/lint.css">
    <link rel="stylesheet" href="css/dracula.css">
    <link rel="stylesheet" href="css/complemento.css">
    <link rel="stylesheet" href="addon/scroll/simplescrollbars.css">
    <link rel="stylesheet" type="text/css" href="css/prism.css">




    <script type="text/javascript" src="js/codemirror.js"></script>
    <script type="text/javascript" src="js/javascript.js"></script>
    <script type="text/javascript" src="js/css.js"></script>
    <script type="text/javascript" src="js/htmlmixed.js"></script>
    <script type="text/javascript" src="js/xml.js"></script>
    <script type="text/javascript" src="js/lint.js"></script>
    <script type="text/javascript" src="js/javascript-lint.js"></script>
    <script type="text/javascript" src="js/json-lint.js"></script>
    <script type="text/javascript" src="js/css-lint.js"></script>
    <script type="text/javascript" src="js/html-lint.js"></script>
    <script type="text/javascript" src="js/jshint.js"></script>
    <script type="text/javascript" src="js/jsonlint.js"></script>
    <script type="text/javascript" src="https://csslint.net/js/csslint.js"></script>
    <script type="text/javascript" src="js/closetag.js"></script>
    <script type="text/javascript" src="js/matchbrackets.js"></script>
    <script type="text/javascript" src="js/active-line.js"></script>
    <script type="text/javascript" src="js/foldcode.js"></script>
    <script type="text/javascript" src="js/foldgutter.js"></script>
    <script type="text/javascript" src="js/brace-fold.js"></script>
    <script type="text/javascript" src="js/xml-fold.js"></script>
    <script type="text/javascript" src="js/comment-fold.js"></script>
    <!-- js scrollbar-->
    <script type="text/javascript" src="addon/scroll/simplescrollbars.js"></script>
    <script type="text/javascript" src="addon/wrap/hardwrap.js"></script>
    <script type="text/javascript" src="js/prism.js"></script>
    <style id="compiled-css" type="text/css"></style>

    <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="assets/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/icons/favicon-16x16.png">

    <script src="libs/vendor/jquery-2.1.4.min.js"></script>
    <!--script defer src="controllers/ArmRobotController.js"></script-->
    <!--script defer src="virtualizers/ArmRobotVirtualizer.js"></script-->
    <!--script defer src="dist/msw.js"></script-->
    <!--script defer src="dist/server.js"></script-->
    <script defer src="libs/vendor/three.min.js"></script>
    <script src="libs/vendor/threex.volumetricspotlightmaterial.js"></script>
    <script defer src="libs/vendor/stats.min.js"></script>
    <script defer src="libs/vendor/physi.js"></script>
    <script defer src="libs/vendor/dat.gui.js"></script>
    <script defer src="libs/vendor/chroma.js"></script>

    <script defer src="libs/vendor/ThreeBSP.js"></script>
    <script defer src="libs/vendor/STLLoader.js"></script>
    <script defer src="libs/vendor/orbit.js"></script>
    <script defer src="fgmm_config/default.js"></script>
    <script defer src="fgmm_config/gui.js"></script>
    <!--script src="representations/ArmRobotRepresentation.js"></script-->
    <script defer src="libs/robothree/robothree.js"></script>
    <script defer src="representations/Portal.js"></script>

    <!--<script defer src="robots/ThreeWheelDistanceSensingRobot.js"></script>-->

</head>

<body style="background-color: rgb(2,51,175); margin:0;">

    <div class="container-fluid d-flex justify-content-start flex-nowrap" style="margin-top:25px; gap:0px; width:100%;">
        <!-- EDITOR DE CODIGO-->
        <div class="card align-self-stretch w-50"
            style="background-color:rgb(40,42,54);box-shadow:inset; border-radius:15px; margin-left:0px; width:95vh; height:95vh;">

            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <button class="nav-link active" id="editor-tab" data-toggle="tab" data-target="#editor"
                        type="button" role="tab">Editor</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" id="docs-tab" data-toggle="tab" data-target="#docs" type="button"
                        role="tab">Documentación</button>
                </li>
            </ul>
            <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade show active card-body" id="editor" role="tabpanel">
                    <textarea class="input-group overflow-auto" style="margin: auto;" id="code-js" name="code-js">var portal = new Portal();
portal.moverPitch(90);
portal.esperar(300);
portal.moverPitch(0,[0,2,4,6]);
                </textarea>
                    <div class="button-bar-code"
                        style="display: flex; align-items: center; justify-content: space-between; height:10vh">
                        <button type="button" class="btn btn-success p-2 bd-highlight" id="dwn-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="4vh"
                                viewBox="0 0 24 24" width="4vh" fill="#FFFFFF">
                                <g>
                                    <rect fill="none" height="4vh" width="4vh" />
                                </g>
                                <g>
                                    <path
                                        d="M18,15v3H6v-3H4v3c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2v-3H18z M17,11l-1.41-1.41L13,12.17V4h-2v8.17L8.41,9.59L7,11l5,5 L17,11z" />
                                </g>
                            </svg>
                        </button>

                        <button id="run-code" type="button" class="btn btn-success p-2 bd-highlight">
                            <svg xmlns="http://www.w3.org/2000/svg" height="4vh" viewBox="0 0 24 24" width="4vh"
                                fill="#FFFFFF">
                                <path d="M0 0h24v24H0V0z" fill="none" />
                                <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z" />
                            </svg>
                        </button>
                        <div id="terminal" class="card align-self-stretch w-40 h-10"
                            style="background-color: black; color: lime; ;overflow: auto ; width: 70vh; height:8vh; white-space:pre-wrap;">
                        </div>

                    </div>

                </div>
                <div class="tab-pane fade card-body overflow-scroll" id="docs" role="tabpanel"
                    style="background-color: #282a36; color:white; height:85vh;">
                    <div style="height:100%; overflow:scroll;">
                        <h2> Portal DMX</h2>
                        <pre><code class="language-javascript">var portal = new Portal();</code></pre>
                        <p>Se crea un nuevo objetivo de la clase Portal. El objeto nos permite controlar el portal de
                            luz.
                        </p>
                        <pre><code class="language-javascript">portal.esperar(tiempo);</code></pre>
                        <p>Permite detener la ejecución del programa por [tiempo] cuadros. La ejecución queda detenida
                            para todos los DMX.</p>
                        <pre><code class="language-javascript">portal.cambiarRapidezYaw(vel, dmx_control = [0,1,2,3,4,5,6,7]);</code></pre>
                        <p>Permite cambiar la rapidez del movimiento Yaw. Recibe un valor entre 0 y 255. Solo ejecuta el
                            cambio para los DMX especificados en el arreglo dmx_control.
                        </p>
                        <pre><code class="language-javascript">portal.cambiarRapidezPitch(vel, dmx_control = [0,1,2,3,4,5,6,7]);</code></pre>
                        <p>Permite cambiar la rapidez del movimiento Yaw. Recibe un valor entre 0 y 255. Solo ejecuta el
                            cambio para los DMX especificados en el arreglo dmx_control.
                        </p>
                        <pre><code class="language-javascript">portal.cambiarColorLuz(color, intensity, dmx_control = [0,1,2,3,4,5,6,7]);</code></pre>
                        <p>Permite cambiar el color y la intensidad de la luz de los DMX especificados. El color puede
                            ser una String en inglés del color (“red”, “blue”, “black”, “purple”, etc.). La intensidad
                            recibe un valor entre 0 y 255.
                        </p>
                        <pre><code class="language-javascript">portal.moverPitch(angulo, dmx_control = [0,1,2,3,4,5,6,7]);</code></pre>
                        <p>Permite rotar el DMX a lo largo de la orientación Pitch. El ángulo recibe un valor entre -100
                            grados y +100 grados. Solo ejecuta el cambio para los DMX especificados en el arreglo
                            dmx_control.
                        </p>
                        <pre><code class="language-javascript">portal.moverYaw(angulo, dmx_control = [0,1,2,3,4,5,6,7]);</code></pre>
                        <p>Permite rotar el DMX a lo largo de la orientación Yaw. El ángulo recibe un valor entre -170
                            grados y +170 grados. Solo ejecuta el cambio para los DMX especificados en el arreglo
                            dmx_control.
                        </p>
                    </div>
                </div>

            </div>
        </div>


        <!-- SIMULADOR -->
        <div class="card d-flex p-2 align-self-center w-50" style="border-radius:15px; margin-left:15px; height:95vh;">
            <div hidden id="gui-container" style="z-index: 100; position: absolute;"></div>
            <canvas id="robothree" style="border-radius:15px; width: 100%; height: 100%; z-index: 1; "></canvas>
        </div>

        <script type="text/javascript">
            $(document).ready(() => {

                $('#run-code').click(() => {
                    var text2 = editor.getValue();
                    try {
                        eval(text2);
                    } catch (error) {
                        appendToTerminal('Error: ' + error.message + '\n');
                        return;
                    }
                    appendToTerminal('Código enviado correctamente \n');
                });

            });

            var editor = CodeMirror.fromTextArea(document.getElementById("code-js"), {
                mode: "javascript",
                theme: "dracula",
                scrollbarStyle: "simple",
                lineNumbers: true,
                gutters: ["CodeMirror-lint-markers"],
                lint: true
            });
            const savedCode = localStorage.getItem('code');
            if (savedCode) {
                editor.setValue(savedCode);
            }
            editor.on('change', function (cm) {
                // Save code in localStorage whenever it changes
                localStorage.setItem('code', cm.getValue());
            });

            //descarga del archivo
            function download(filename, text) {
                var element = document.createElement('a');
                element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
                element.setAttribute('download', filename);
                element.style.display = 'none';
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            }
            document.getElementById("dwn-btn").addEventListener("click", function () {
                var text = editor.getValue();
                var fecha = new Date();
                var filename = "Codigo " + fecha.getFullYear() + "-" + fecha.getMonth() + "-" + fecha.getUTCDate() + " at " + fecha.getHours() + "." + fecha.getMinutes() + "." + fecha.getSeconds() + ".txt"

                download(filename, text);
            }, false);
            editor.setSize("100%", "75vh");
            //size window
            function appendToTerminal(message) {
                var terminal = document.getElementById('terminal');
                terminal.innerHTML += message + '\n';
                // Automatically scroll to the end of the terminal output
                terminal.scrollTop = terminal.scrollHeight;
            }

        </script>



</body>

</html>